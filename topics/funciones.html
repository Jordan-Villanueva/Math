<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Funciones Matemáticas - Teoría y Gráficas</title>
  <style>
    :root { 
      --bg: #fafafa; 
      --card: #ffffff; 
      --accent: #2b7a78; 
      --muted: #666; 
      --light-accent: rgba(43, 122, 120, 0.1);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0 auto;
      max-width: 1400px;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(#f7fbfb, #eef6f6);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, var(--accent), #1a5f5d);
      color: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 2.2rem;
      margin-bottom: 10px;
    }

    h2 {
      font-size: 1.6rem;
      margin-bottom: 15px;
      color: var(--accent);
    }

    h3 {
      font-size: 1.3rem;
      margin-bottom: 12px;
      color: var(--accent);
    }

    .subtitle {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .panel {
      background: var(--card);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 25px;
      transition: transform 0.3s ease;
    }

    .panel:hover {
      transform: translateY(-5px);
    }

    .flex-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .theory-container {
      flex: 1;
      min-width: 300px;
    }

    .graphics-container {
      flex: 2;
      min-width: 300px;
    }

    .small { 
      font-size: 0.9rem; 
      color: var(--muted); 
      margin-bottom: 10px;
    }

    select, input {
      width: 100%;
      padding: 12px 15px;
      font-size: 1rem;
      margin-bottom: 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      background: white;
      color: #333;
      transition: border-color 0.3s;
    }

    select:focus, input:focus {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 3px rgba(43, 122, 120, 0.2);
    }

    .btn {
      padding: 12px 18px;
      border-radius: 8px;
      border: none;
      background: var(--accent);
      color: white;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s;
    }

    .btn:hover { 
      background: #1f5f5d; 
    }

    .mutebtn {
      background: #ddd;
      color: #333;
    }

    .mutebtn:hover { 
      background: #ccc; 
    }

    .graph-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin: 15px 0;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control-group label {
      font-size: 0.95rem;
      color: var(--muted);
      font-weight: 500;
    }

    .animation-container {
      width: 100%;
      margin: 20px 0;
      border-radius: 8px;
      overflow: hidden;
      background: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      position: relative;
    }
    
    #graphCanvas {
      display: block;
      width: 100%;
      height: 400px;
      background: #fcfefe;
    }

    .zoom-controls {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .zoom-btn {
      padding: 8px 14px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      font-weight: bold;
    }
    
    .zoom-btn:hover {
      background: #f0f0f0;
    }
    
    .zoom-info {
      font-size: 0.9rem;
      color: var(--muted);
      margin-left: 10px;
    }

    .output {
      margin-top: 20px;
      padding: 20px;
      background: #e8eaf6;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
      font-size: 1.1rem;
      line-height: 1.8;
      border-left: 5px solid var(--accent);
    }

    .theory-content {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .theory-section {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .theory-section h3 {
      color: var(--accent);
      margin-bottom: 10px;
    }

    .theory-section p {
      margin-bottom: 10px;
      line-height: 1.6;
    }

    .theory-list {
      padding-left: 20px;
      margin-bottom: 10px;
    }

    .theory-list li {
      margin-bottom: 8px;
    }

    @media (max-width: 900px) {
      .flex-container {
        flex-direction: column;
      }
      
      .panel {
        padding: 15px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      h2 {
        font-size: 1.4rem;
      }
      
      #graphCanvas {
        height: 300px;
      }
      
      .zoom-controls {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1>Funciones Matemáticas - Teoría y Gráficas</h1>
      <p class="subtitle">Visualiza y comprende las funciones matemáticas con gráficas interactivas</p>
    </header>

    <div class="flex-container">
      <div class="panel theory-container">
        <h2>Teoría de Funciones</h2>
        
        <div class="theory-content">
          <div class="theory-section">
            <h3>¿Qué es una función?</h3>
            <p>Una función es una relación entre dos conjuntos (dominio y codominio) donde cada elemento del dominio se relaciona con exactamente un elemento del codominio.</p>
            <p>Notación: f: A → B, donde A es el dominio y B es el codominio.</p>
          </div>
          
          <div class="theory-section">
            <h3>Tipos de Funciones</h3>
            <ul class="theory-list">
              <li><strong>Lineales:</strong> f(x) = mx + b</li>
              <li><strong>Cuadráticas:</strong> f(x) = ax² + bx + c</li>
              <li><strong>Polinómicas:</strong> f(x) = aₙxⁿ + ... + a₁x + a₀</li>
              <li><strong>Racionales:</strong> f(x) = P(x)/Q(x)</li>
              <li><strong>Exponenciales:</strong> f(x) = aˣ</li>
              <li><strong>Logarítmicas:</strong> f(x) = logₐ(x)</li>
              <li><strong>Trigonométricas:</strong> sen(x), cos(x), tan(x)</li>
              <li><strong>Valor absoluto:</strong> f(x) = |x|</li>
            </ul>
          </div>
          
          <div class="theory-section">
            <h3>Dominio de una función</h3>
            <p>El dominio de una función es el conjunto de todos los valores de entrada (x) para los cuales la función está definida.</p>
            <p><strong>Ejemplos:</strong></p>
            <ul class="theory-list">
              <li>f(x) = √x → Dominio: x ≥ 0</li>
              <li>f(x) = 1/x → Dominio: x ≠ 0</li>
              <li>f(x) = log(x) → Dominio: x > 0</li>
            </ul>
          </div>
          
          <div class="theory-section">
            <h3>Rango de una función</h3>
            <p>El rango de una función es el conjunto de todos los valores de salida (y) que resultan de evaluar la función en su dominio.</p>
            <p><strong>Ejemplos:</strong></p>
            <ul class="theory-list">
              <li>f(x) = x² → Rango: y ≥ 0</li>
              <li>f(x) = sen(x) → Rango: -1 ≤ y ≤ 1</li>
              <li>f(x) = eˣ → Rango: y > 0</li>
            </ul>
          </div>
          
          <div class="theory-section">
            <h3>Composición de funciones</h3>
            <p>La composición de funciones es la aplicación sucesiva de funciones. Se denota como (f ∘ g)(x) = f(g(x)).</p>
            <p><strong>Ejemplo:</strong> Si f(x) = x² y g(x) = x + 1, entonces (f ∘ g)(x) = f(g(x)) = (x + 1)²</p>
          </div>
        </div>
      </div>
      
      <div class="panel graphics-container">
        <h2>Visualización de Funciones</h2>
        <p class="small">Selecciona el tipo de función y ajusta sus parámetros.</p>
        
        <div class="control-group">
          <label for="functionType">Tipo de función:</label>
          <select id="functionType">
            <option value="linear">Lineal (mx + b)</option>
            <option value="quadratic">Cuadrática (ax² + bx + c)</option>
            <option value="polynomial">Polinómica (ax³ + bx² + cx + d)</option>
            <option value="rational">Racional (P(x)/Q(x))</option>
            <option value="exponential">Exponencial (aˣ)</option>
            <option value="logarithmic">Logarítmica (logₐ(x))</option>
            <option value="trigonometric">Trigonométrica</option>
            <option value="absolute">Valor absoluto (|x|)</option>
          </select>
        </div>
        
        <div id="dynamicControls">
          <div class="control-group">
            <label for="paramM">Pendiente (m):</label>
            <input type="number" id="paramM" value="1" step="0.1">
          </div>
          <div class="control-group">
            <label for="paramB">Intercepto (b):</label>
            <input type="number" id="paramB" value="0" step="0.1">
          </div>
        </div>
        
        <button class="btn" id="plotBtn">Graficar Función</button>
        <button class="btn mutebtn" id="resetBtn">Reiniciar</button>
        
        <div class="output" id="functionOutput">
          La información de la función aparecerá aquí después de graficar.
        </div>
        
        <div class="animation-container">
          <canvas id="graphCanvas"></canvas>
        </div>
        
        <div class="zoom-controls">
          <button class="zoom-btn" id="zoomInBtn">+ Zoom</button>
          <button class="zoom-btn" id="zoomOutBtn">- Zoom</button>
          <button class="zoom-btn" id="panLeftBtn">←</button>
          <button class="zoom-btn" id="panRightBtn">→</button>
          <button class="zoom-btn" id="panUpBtn">↑</button>
          <button class="zoom-btn" id="panDownBtn">↓</button>
          <button class="btn mutebtn" id="resetViewBtn">Vista Predeterminada</button>
          <button class="btn" id="autoViewBtn">Auto-ajustar Vista</button>
          <span class="zoom-info" id="zoomLevelInfo">Zoom: 100%</span>
        </div>
        
        <div class="graph-controls">
          <div class="control-group">
            <label for="xMin">X mínimo:</label>
            <input type="number" id="xMin" value="-10" step="1">
          </div>
          <div class="control-group">
            <label for="xMax">X máximo:</label>
            <input type="number" id="xMax" value="10" step="1">
          </div>
          <div class="control-group">
            <label for="yMin">Y mínimo:</label>
            <input type="number" id="yMin" value="-10" step="1">
          </div>
          <div class="control-group">
            <label for="yMax">Y máximo:</label>
            <input type="number" id="yMax" value="10" step="1">
          </div>
        </div>
      </div>
    </div>
  </div>

	  <script>
	/* ---------- Variables globales ---------- */
	const canvas = document.getElementById('graphCanvas');
	const ctx = canvas.getContext('2d');
	let zoomLevel = 1;
	let xMin = -10, xMax = 10, yMin = -10, yMax = 10;

	/* ---------- Inicialización del canvas ---------- */
	function initCanvas() {
	  const container = canvas.parentElement;
	  canvas.width = container.clientWidth;
	  canvas.height = 400;
	  drawGrid();
	}

	/* ---------- Dibujar cuadrícula y ejes ---------- */
	function drawGrid() {
	  const width = canvas.width;
	  const height = canvas.height;
	  ctx.clearRect(0,0,width,height);
	  ctx.fillStyle = '#fcfefe';
	  ctx.fillRect(0,0,width,height);

	  const xScale = width / (xMax - xMin);
	  const yScale = height / (yMax - yMin);
	  const xOffset = -xMin * xScale;
	  const yOffset = yMax * yScale;

	  // cuadrícula
	  ctx.strokeStyle = '#e0e0e0';
	  ctx.lineWidth = 1;
	  for (let x = Math.ceil(xMin); x <= xMax; x++) {
	    const px = x * xScale + xOffset;
	    ctx.beginPath(); ctx.moveTo(px,0); ctx.lineTo(px,height); ctx.stroke();
	  }
	  for (let y = Math.ceil(yMin); y <= yMax; y++) {
	    const py = yOffset - y * yScale;
	    ctx.beginPath(); ctx.moveTo(0,py); ctx.lineTo(width,py); ctx.stroke();
	  }

	  // ejes
	  ctx.strokeStyle = '#333'; ctx.lineWidth = 2;
	  const xAxisY = yOffset; if (xAxisY >= 0 && xAxisY <= height) { ctx.beginPath(); ctx.moveTo(0,xAxisY); ctx.lineTo(width,xAxisY); ctx.stroke(); }
	  const yAxisX = xOffset; if (yAxisX >= 0 && yAxisX <= width)  { ctx.beginPath(); ctx.moveTo(yAxisX,0); ctx.lineTo(yAxisX,height); ctx.stroke(); }

	  // marcas y números
	  ctx.fillStyle = '#333'; ctx.font = '12px Arial'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
	  for (let x = Math.ceil(xMin); x <= xMax; x++) {
	    if (x === 0) continue;
	    const px = x * xScale + xOffset;
	    if (px >= 0 && px <= width) { ctx.beginPath(); ctx.moveTo(px, xAxisY-5); ctx.lineTo(px, xAxisY+5); ctx.stroke(); ctx.fillText(x.toString(), px, xAxisY + 15); }
	  }
	  for (let y = Math.ceil(yMin); y <= yMax; y++) {
	    if (y === 0) continue;
	    const py = yOffset - y * yScale;
	    if (py >= 0 && py <= height) { ctx.beginPath(); ctx.moveTo(yAxisX-5, py); ctx.lineTo(yAxisX+5, py); ctx.stroke(); ctx.fillText(y.toString(), yAxisX - 15, py); }
	  }
	  if (xOffset >= 0 && xOffset <= width && xAxisY >= 0 && xAxisY <= height) ctx.fillText("0", xOffset - 12, xAxisY + 15);
	}

	/* ---------- Controles dinámicos (añadir inputs según tipo) ---------- */
	function updateControls() {
	  const type = document.getElementById('functionType').value;
	  const c = document.getElementById('dynamicControls');
	  let html = '';

	  switch(type) {
	    case 'linear':
	      html = `
		<div class="control-group"><label for="paramM">Pendiente (m):</label><input type="number" id="paramM" value="1" step="0.1"></div>
		<div class="control-group"><label for="paramB">Intercepto (b):</label><input type="number" id="paramB" value="0" step="0.1"></div>
	      `;
	      break;

	    case 'quadratic':
	      html = `
		<div class="control-group"><label for="paramA">a:</label><input type="number" id="paramA" value="1" step="0.1"></div>
		<div class="control-group"><label for="paramBq">b:</label><input type="number" id="paramBq" value="0" step="0.1"></div>
		<div class="control-group"><label for="paramC">c:</label><input type="number" id="paramC" value="0" step="0.1"></div>
	      `;
	      break;

	    case 'polynomial':
	      // grado 3
	      html = `
		<div class="control-group"><label for="paramA3">a₃ (x³):</label><input type="number" id="paramA3" value="0" step="0.1"></div>
		<div class="control-group"><label for="paramA2">a₂ (x²):</label><input type="number" id="paramA2" value="0" step="0.1"></div>
		<div class="control-group"><label for="paramA1">a₁ (x):</label><input type="number" id="paramA1" value="1" step="0.1"></div>
		<div class="control-group"><label for="paramA0">a₀ (const):</label><input type="number" id="paramA0" value="0" step="0.1"></div>
	      `;
	      break;

	    case 'rational':
	  html = `
	    <h4>Numerador</h4>
	    <div class="control-group"><label for="paramRatA3">a₃ (x³):</label><input type="number" id="paramRatA3" value="0" step="0.1"></div>
	    <div class="control-group"><label for="paramRatA2">a₂ (x²):</label><input type="number" id="paramRatA2" value="0" step="0.1"></div>
	    <div class="control-group"><label for="paramRatA1">a₁ (x):</label><input type="number" id="paramRatA1" value="1" step="0.1"></div>
	    <div class="control-group"><label for="paramRatA0">a₀:</label><input type="number" id="paramRatA0" value="0" step="0.1"></div>

	    <h4>Denominador</h4>
	    <div class="control-group"><label for="paramRatB3">b₃ (x³):</label><input type="number" id="paramRatB3" value="0" step="0.1"></div>
	    <div class="control-group"><label for="paramRatB2">b₂ (x²):</label><input type="number" id="paramRatB2" value="0" step="0.1"></div>
	    <div class="control-group"><label for="paramRatB1">b₁ (x):</label><input type="number" id="paramRatB1" value="1" step="0.1"></div>
	    <div class="control-group"><label for="paramRatB0">b₀:</label><input type="number" id="paramRatB0" value="0" step="0.1"></div>
	  `;
	  break;

	    case 'exponential':
	      html = `<div class="control-group"><label for="paramBase">Base:</label><input type="number" id="paramBase" value="${Math.E.toFixed(2)}" step="0.1"></div>`;
	      break;

	    case 'logarithmic':
	      html = `<div class="control-group"><label for="paramLogBase">Base:</label><input type="number" id="paramLogBase" value="${Math.E.toFixed(2)}" step="0.1" min="0.1"></div>`;
	      break;

	    case 'trigonometric':
	      html = `
		<div class="control-group"><label for="trigFunction">Función:</label>
		  <select id="trigFunction"><option value="sin">seno</option><option value="cos">coseno</option><option value="tan">tangente</option></select></div>
		<div class="control-group"><label for="trigAmplitude">Amplitud:</label><input type="number" id="trigAmplitude" value="1" step="0.1"></div>
		<div class="control-group"><label for="trigFrequency">Frecuencia:</label><input type="number" id="trigFrequency" value="1" step="0.1"></div>
		<div class="control-group"><label for="trigPhase">Fase:</label><input type="number" id="trigPhase" value="0" step="0.1"></div>
		<div class="control-group"><label for="trigConstant">Constante:</label><input type="number" id="trigConstant" value="0" step="0.1"></div>
	      `;
	      break;

	    case 'absolute':
	      html = `<div class="control-group"><p>f(x) = |x|</p></div>`;
	      break;
	  }

	  c.innerHTML = html;
	}

	/* ---------- Evaluador de funciones ---------- */
	function evaluateFunction(x, type) {
	  if (!isFinite(x)) return NaN;

	  switch(type) {
	    case 'linear': {
	      const m = parseFloat(document.getElementById('paramM')?.value || 1);
	      const b = parseFloat(document.getElementById('paramB')?.value || 0);
	      return m * x + b;
	    }
	    case 'quadratic': {
	      const a = parseFloat(document.getElementById('paramA')?.value || 1);
	      const bq = parseFloat(document.getElementById('paramBq')?.value || 0);
	      const c = parseFloat(document.getElementById('paramC')?.value || 0);
	      return a * x * x + bq * x + c;
	    }
	    case 'polynomial': {
	      const a3 = parseFloat(document.getElementById('paramA3')?.value || 0);
	      const a2 = parseFloat(document.getElementById('paramA2')?.value || 0);
	      const a1 = parseFloat(document.getElementById('paramA1')?.value || 0);
	      const a0 = parseFloat(document.getElementById('paramA0')?.value || 0);
	      return a3 * x*x*x + a2 * x*x + a1 * x + a0;
	    }
	    case 'rational': {
	      const a3 = parseFloat(document.getElementById('paramRatA3')?.value || 0);
	      const a2 = parseFloat(document.getElementById('paramRatA2')?.value || 0);
	      const a1 = parseFloat(document.getElementById('paramRatA1')?.value || 0);
	      const a0 = parseFloat(document.getElementById('paramRatA0')?.value || 0);

	      const b3 = parseFloat(document.getElementById('paramRatB3')?.value || 0);
	      const b2 = parseFloat(document.getElementById('paramRatB2')?.value || 0);
	      const b1 = parseFloat(document.getElementById('paramRatB1')?.value || 0);
	      const b0 = parseFloat(document.getElementById('paramRatB0')?.value || 0);

	      const denom = b3*x**3 + b2*x**2 + b1*x + b0;

	      if (Math.abs(denom) < 1e-8) {
		return NaN; // tratar como punto de discontinuidad
	      }

	      return (a3*x**3 + a2*x**2 + a1*x + a0) / denom;
	    }

	    case 'exponential': {
	      const base = parseFloat(document.getElementById('paramBase')?.value) || Math.E;
	      return Math.pow(base, x);
	    }
	    case 'logarithmic': {
	      const logBase = parseFloat(document.getElementById('paramLogBase')?.value) || Math.E;
	      if (x <= 0) return NaN;
	      return Math.log(x) / Math.log(logBase);
	    }
	    case 'trigonometric': {
	      const trigType = document.getElementById('trigFunction')?.value || 'sin';
	      const amplitude = parseFloat(document.getElementById('trigAmplitude')?.value || 1);
	      const frequency = parseFloat(document.getElementById('trigFrequency')?.value || 1);
	      const phase = parseFloat(document.getElementById('trigPhase')?.value || 0);
	      const constant = parseFloat(document.getElementById('trigConstant')?.value || 0);
	      if (trigType === 'sin') return amplitude * Math.sin(frequency * x + phase) + constant;
	      if (trigType === 'cos') return amplitude * Math.cos(frequency * x + phase) + constant;
	      if (trigType === 'tan') return amplitude * Math.tan(frequency * x + phase) + constant;
	      return Math.sin(x);
	    }
	    case 'absolute':
	      return Math.abs(x);
	    default:
	      return x;
	  }
	}

	/* ---------- Graficar función (robusta, rompe en discontinuidades) ---------- */
	function plotFunction() {
	  drawGrid();
	  const type = document.getElementById('functionType').value;
	  const width = canvas.width, height = canvas.height;
	  const xScale = width / (xMax - xMin);
	  const yScale = height / (yMax - yMin);
	  const xOffset = -xMin * xScale;
	  const yOffset = yMax * yScale;

	  ctx.strokeStyle = '#2b7a78';
	  ctx.lineWidth = 2;
	  ctx.beginPath();

	  let penDown = false;
	  let lastPy = null;
	  // threshold: si |y| muy grande, se considera discontinuidad
	  const yThreshold = Math.max( (yMax - yMin) * 5, 1e4 );

	  for (let px = 0; px <= width; px++) {
	    const x = xMin + px / xScale; // coordenada mundo
	    const y = evaluateFunction(x, type);

	    if (!isFinite(y) || Math.abs(y) > yThreshold) {
	      penDown = false;
	      lastPy = null;
	      continue;
	    }

	    const py = yOffset - y * yScale;

	    if (!penDown) {
	      ctx.moveTo(px, py);
	      penDown = true;
	      lastPy = py;
	    } else {
	      // si salto vertical enorme entre puntos, romper trazo (evita líneas que cruzan una asíntota)
	      if (lastPy !== null && Math.abs(py - lastPy) > height * 0.6) {
		ctx.moveTo(px, py);
	      } else {
		ctx.lineTo(px, py);
	      }
	      lastPy = py;
	    }
	  }

	  ctx.stroke();

	  // mostrar info
	  updateFunctionInfo(type);
	}

	/* ---------- Mostrar información de la función ---------- */
	function updateFunctionInfo(type) {
	  let text = "", domain = "", range = "";
	  switch(type) {
	    case 'linear': {
	      const m = parseFloat(document.getElementById('paramM')?.value || 1);
	      const b = parseFloat(document.getElementById('paramB')?.value || 0);
	      text = `f(x) = ${m}x ${b >= 0 ? '+' : ''}${b}`;
	      domain = "ℝ"; range = "ℝ";
	      break;
	    }
	    case 'quadratic': {
	      const a = parseFloat(document.getElementById('paramA')?.value || 1);
	      const bq = parseFloat(document.getElementById('paramBq')?.value || 0);
	      const c = parseFloat(document.getElementById('paramC')?.value || 0);
	      text = `f(x) = ${a}x² ${bq >= 0 ? '+' : ''}${bq}x ${c >= 0 ? '+' : ''}${c}`;
	      domain = "ℝ";
	      const vertexY = c - (bq*bq)/(4*a);
	      range = a > 0 ? `[${vertexY.toFixed(2)}, ∞)` : `(-∞, ${vertexY.toFixed(2)}]`;
	      break;
	    }
	    case 'polynomial': {
	      const a3 = parseFloat(document.getElementById('paramA3')?.value || 0);
	      const a2 = parseFloat(document.getElementById('paramA2')?.value || 0);
	      const a1 = parseFloat(document.getElementById('paramA1')?.value || 1);
	      const a0 = parseFloat(document.getElementById('paramA0')?.value || 0);
	      text = `f(x) = ${a3}x³ ${a2 >= 0 ? '+' : ''}${a2}x² ${a1 >= 0 ? '+' : ''}${a1}x ${a0 >= 0 ? '+' : ''}${a0}`;
	      domain = "ℝ"; range = "ℝ (dependiente de los coeficientes)";
	      break;
	    }
	   case 'rational': {
	    // Coeficientes del numerador y denominador (lineal)
	    const a = parseFloat(document.getElementById('paramRatA')?.value || 1);
	    const b = parseFloat(document.getElementById('paramRatB')?.value || 0);
	    const c = parseFloat(document.getElementById('paramRatC')?.value || 1);
	    const d = parseFloat(document.getElementById('paramRatD')?.value || 0);

	    // Representación en texto de la función
	    text = `f(x) = (${a}x ${b >= 0 ? '+' : ''}${b}) / (${c}x ${d >= 0 ? '+' : ''}${d})`;

	    // Dominio evitando división por cero
	    domain = `ℝ \\ {x | ${c}x + ${d} = 0}`;

	    // Rango genérico
	    range = "depende; puede haber asíntotas";

	    // Función evaluadora segura
	    evaluator = function(x) {
		const denom = c * x + d;
		if (Math.abs(denom) < 1e-8) return NaN; // punto de discontinuidad
		return (a * x + b) / denom;
	    };

	    break;
	}

	    // otros tipos...
	    default:
	      text = type;
	      domain = "Ver definición";
	      range = "Ver definición";
	  }

	  document.getElementById('functionOutput').textContent = 
    `Función: ${text}\nDominio: ${domain}\nRango: ${range}`;

	}

	/* ---------- Auto-ajustar vista (heurística para polinomios/racionales) ---------- */
	function autoAdjustView() {
	  const type = document.getElementById('functionType').value;

	  if (type === 'polynomial') {
	    const a3 = Math.abs(parseFloat(document.getElementById('paramA3')?.value || 0));
	    const a2 = Math.abs(parseFloat(document.getElementById('paramA2')?.value || 0));
	    const a1 = Math.abs(parseFloat(document.getElementById('paramA1')?.value || 1));
	    const a0 = Math.abs(parseFloat(document.getElementById('paramA0')?.value || 0));
	    // heurística: cuanto mayores los coeficientes, más pequeño el rango x
	    const magnitude = Math.max(a3, a2, a1, a0, 1);
	    const xr = Math.max(4, 8 / Math.pow(magnitude, 1/3));
	    xMin = -xr; xMax = xr;
	    yMin = -xr * 2; yMax = xr * 2;
	  } else if (type === 'rational') {
	    const c = parseFloat(document.getElementById('paramRatC')?.value || 1);
	    const d = parseFloat(document.getElementById('paramRatD')?.value || 0);
	    // centrar la vista cerca de la posible asíntota vertical x = -d/c
	    if (Math.abs(c) > 1e-9) {
	      const asym = -d / c;
	      xMin = asym - 8; xMax = asym + 8;
	      yMin = -8; yMax = 8;
	    } else {
	      xMin = -10; xMax = 10; yMin = -8; yMax = 8;
	    }
	  } else if (type === 'quadratic') {
	    xMin = -6; xMax = 6; yMin = -10; yMax = 10;
	  } else if (type === 'trigonometric') {
	    xMin = -2 * Math.PI; xMax = 2 * Math.PI; yMin = -3; yMax = 3;
	  } else if (type === 'exponential') {
	    xMin = -2; xMax = 5; yMin = -1; yMax = 20;
	  } else {
	    xMin = -10; xMax = 10; yMin = -10; yMax = 10;
	  }

	  updateView();
	}

	/* ---------- Zoom, pan, reset ---------- */
	function zoomIn() {
	  const cx = (xMin + xMax) / 2, cy = (yMin + yMax) / 2;
	  const nx = (xMax - xMin) * 0.8, ny = (yMax - yMin) * 0.8;
	  xMin = cx - nx/2; xMax = cx + nx/2; yMin = cy - ny/2; yMax = cy + ny/2;
	  updateView();
	}
	function zoomOut() {
	  const cx = (xMin + xMax) / 2, cy = (yMin + yMax) / 2;
	  const nx = (xMax - xMin) / 0.8, ny = (yMax - yMin) / 0.8;
	  xMin = cx - nx/2; xMax = cx + nx/2; yMin = cy - ny/2; yMax = cy + ny/2;
	  updateView();
	}
	function panLeft() { const r = xMax - xMin; xMin -= r*0.1; xMax -= r*0.1; updateView(); }
	function panRight(){ const r = xMax - xMin; xMin += r*0.1; xMax += r*0.1; updateView(); }
	function panUp()   { const r = yMax - yMin; yMin += r*0.1; yMax += r*0.1; updateView(); }
	function panDown() { const r = yMax - yMin; yMin -= r*0.1; yMax -= r*0.1; updateView(); }
	function resetView(){ xMin=-10;xMax=10;yMin=-10;yMax=10; updateView(); }

	function updateView() {
	  document.getElementById('xMin').value = Math.round(xMin*100)/100;
	  document.getElementById('xMax').value = Math.round(xMax*100)/100;
	  document.getElementById('yMin').value = Math.round(yMin*100)/100;
	  document.getElementById('yMax').value = Math.round(yMax*100)/100;
	  const originalRange = 20;
	  const currentRange = xMax - xMin;
	  zoomLevel = originalRange / currentRange;
	  document.getElementById('zoomLevelInfo').textContent = `Zoom: ${Math.round(zoomLevel*100)}%`;
	  plotFunction();
	}

	/* ---------- Inicialización y listeners ---------- */
	function init() {
	  initCanvas();
	  updateControls();
	  window.addEventListener('resize', initCanvas);

	  document.getElementById('functionType').addEventListener('change', () => { updateControls(); });
	  document.getElementById('plotBtn').addEventListener('click', plotFunction);
	  document.getElementById('resetBtn').addEventListener('click', function(){ resetView(); updateControls(); });
	  document.getElementById('resetViewBtn').addEventListener('click', resetView);
	  document.getElementById('autoViewBtn').addEventListener('click', autoAdjustView);

	  document.getElementById('zoomInBtn').addEventListener('click', zoomIn);
	  document.getElementById('zoomOutBtn').addEventListener('click', zoomOut);
	  document.getElementById('panLeftBtn').addEventListener('click', panLeft);
	  document.getElementById('panRightBtn').addEventListener('click', panRight);
	  document.getElementById('panUpBtn').addEventListener('click', panUp);
	  document.getElementById('panDownBtn').addEventListener('click', panDown);

	  document.getElementById('xMin').addEventListener('change', function(){ xMin = parseFloat(this.value); plotFunction(); });
	  document.getElementById('xMax').addEventListener('change', function(){ xMax = parseFloat(this.value); plotFunction(); });
	  document.getElementById('yMin').addEventListener('change', function(){ yMin = parseFloat(this.value); plotFunction(); });
	  document.getElementById('yMax').addEventListener('change', function(){ yMax = parseFloat(this.value); plotFunction(); });

	  drawGrid();
	}

	document.addEventListener('DOMContentLoaded', init);
	</script>

    
</body>
</html>
